<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 200" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arr" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 Z" fill="#64748b"/>
    </marker>
    <marker id="arr-loop" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 Z" fill="#94a3b8"/>
    </marker>
    <filter id="sh" x="-4%" y="-6%" width="108%" height="120%">
      <feDropShadow dx="0" dy="1.5" stdDeviation="2.5" flood-opacity="0.08"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="700" height="200" rx="10" fill="#f8fafc"/>

  <!-- Step 1: Frame -->
  <g filter="url(#sh)">
    <rect x="40" y="52" width="120" height="64" rx="8" fill="#1e293b"/>
    <text x="100" y="80" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Frame</text>
    <text x="100" y="97" text-anchor="middle" font-size="11" fill="#cbd5e1">causal question</text>
  </g>

  <!-- Arrow 1→2 -->
  <line x1="160" y1="84" x2="195" y2="84" stroke="#64748b" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Step 2: Simulate -->
  <g filter="url(#sh)">
    <rect x="200" y="52" width="120" height="64" rx="8" fill="#0f766e"/>
    <text x="260" y="80" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Simulate</text>
    <text x="260" y="97" text-anchor="middle" font-size="11" fill="#cbd5e1">known truth</text>
  </g>

  <!-- Arrow 2→3 -->
  <line x1="320" y1="84" x2="355" y2="84" stroke="#64748b" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Step 3: Analyze -->
  <g filter="url(#sh)">
    <rect x="360" y="52" width="120" height="64" rx="8" fill="#2563eb"/>
    <text x="420" y="80" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Measure</text>
    <text x="420" y="97" text-anchor="middle" font-size="11" fill="#cbd5e1">naive → causal</text>
  </g>

  <!-- Arrow 3→4 -->
  <line x1="480" y1="84" x2="515" y2="84" stroke="#64748b" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Step 4: Refine -->
  <g filter="url(#sh)">
    <rect x="520" y="52" width="120" height="64" rx="8" fill="#7c3aed"/>
    <text x="580" y="80" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Evaluate</text>
    <text x="580" y="97" text-anchor="middle" font-size="11" fill="#cbd5e1">evidence</text>
  </g>

  <!-- Loop-back arrow: from Refine bottom-right, down, across, up to Frame bottom-left -->
  <path d="M580,116 L580,155 Q580,170 565,170 L115,170 Q100,170 100,155 L100,116"
        fill="none" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="6,4" marker-end="url(#arr-loop)"/>

  <!-- Loop label -->
  <rect x="290" y="160" width="100" height="20" rx="4" fill="#f8fafc"/>
  <text x="340" y="174" text-anchor="middle" font-size="11" fill="#94a3b8" font-style="italic">next lecture</text>

  <!-- Tool badges -->
  <rect x="218" y="38" width="84" height="16" rx="4" fill="#0f766e" opacity="0.15"/>
  <text x="260" y="49" text-anchor="middle" font-size="8.5" fill="#0f766e" font-weight="600">SIMULATOR</text>

  <rect x="372" y="38" width="96" height="16" rx="4" fill="#2563eb" opacity="0.15"/>
  <text x="420" y="49" text-anchor="middle" font-size="8.5" fill="#2563eb" font-weight="600">IMPACT ENGINE</text>
</svg>
