<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 920 340" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arrow" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 Z" fill="#64748b"/>
    </marker>
    <marker id="arrow-truth" viewBox="0 0 10 6" refX="10" refY="3" markerWidth="10" markerHeight="6" orient="auto-start-reverse">
      <path d="M0,0 L10,3 L0,6 Z" fill="#94a3b8"/>
    </marker>
    <filter id="shadow" x="-4%" y="-4%" width="108%" height="116%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.08"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="920" height="340" rx="12" fill="#f8fafc"/>

  <!-- Ground truth reference line -->
  <line x1="225" y1="290" x2="735" y2="290" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="480" y="310" text-anchor="middle" font-size="11" fill="#94a3b8" font-style="italic">known ground truth</text>

  <!-- Step 1: Business Question -->
  <g filter="url(#shadow)">
    <rect x="30" y="120" width="140" height="80" rx="10" fill="#1e293b"/>
    <text x="100" y="155" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Business</text>
    <text x="100" y="174" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Context</text>
  </g>
  <text x="100" y="228" text-anchor="middle" font-size="10" fill="#64748b">Frame causal</text>
  <text x="100" y="241" text-anchor="middle" font-size="10" fill="#64748b">question</text>

  <!-- Arrow 1→2 -->
  <line x1="170" y1="160" x2="210" y2="160" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 2: Simulator -->
  <g filter="url(#shadow)">
    <rect x="220" y="120" width="140" height="80" rx="10" fill="#0f766e"/>
    <text x="290" y="155" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Online Retail</text>
    <text x="290" y="174" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Simulator</text>
  </g>
  <text x="290" y="228" text-anchor="middle" font-size="10" fill="#64748b">Generate data with</text>
  <text x="290" y="241" text-anchor="middle" font-size="10" fill="#64748b">known ground truth</text>

  <!-- Ground truth connector from Simulator -->
  <line x1="290" y1="200" x2="290" y2="290" stroke="#94a3b8" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- Fork arrows from Simulator -->
  <!-- Upper fork (naive) -->
  <path d="M360,145 C390,145 390,75 420,75" fill="none" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  <!-- Lower fork (causal) -->
  <path d="M360,175 C390,175 390,240 420,240" fill="none" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 3a: Naive Comparison (top) -->
  <g filter="url(#shadow)">
    <rect x="420" y="38" width="140" height="80" rx="10" fill="#dc2626" opacity="0.9"/>
    <text x="490" y="72" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Naive</text>
    <text x="490" y="91" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Comparison</text>
  </g>
  <text x="490" y="18" text-anchor="middle" font-size="10" fill="#64748b">Ignores treatment</text>
  <text x="490" y="31" text-anchor="middle" font-size="10" fill="#64748b">assignment mechanism</text>

  <!-- Step 3b: Causal Method (bottom) -->
  <g filter="url(#shadow)">
    <rect x="420" y="200" width="140" height="80" rx="10" fill="#2563eb"/>
    <text x="490" y="235" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Causal</text>
    <text x="490" y="254" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Method</text>
  </g>
  <text x="490" y="300" text-anchor="middle" font-size="10" fill="#64748b">Accounts for</text>
  <text x="490" y="313" text-anchor="middle" font-size="10" fill="#64748b">assignment mechanism</text>

  <!-- Converge arrows -->
  <!-- From naive -->
  <path d="M560,78 C590,78 590,145 620,145" fill="none" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  <!-- From causal -->
  <path d="M560,240 C590,240 590,175 620,175" fill="none" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 4: Compare to Ground Truth -->
  <g filter="url(#shadow)">
    <rect x="620" y="120" width="140" height="80" rx="10" fill="#7c3aed"/>
    <text x="690" y="152" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Compare to</text>
    <text x="690" y="171" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Ground Truth</text>
  </g>
  <text x="690" y="228" text-anchor="middle" font-size="10" fill="#64748b">Evaluate bias</text>
  <text x="690" y="241" text-anchor="middle" font-size="10" fill="#64748b">and accuracy</text>

  <!-- Ground truth connector to Compare -->
  <line x1="690" y1="200" x2="690" y2="290" stroke="#94a3b8" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- Arrow 4→5 -->
  <line x1="760" y1="160" x2="800" y2="160" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 5: Deep Dive -->
  <g filter="url(#shadow)">
    <rect x="800" y="120" width="100" height="80" rx="10" fill="#475569"/>
    <text x="850" y="165" text-anchor="middle" font-size="13" font-weight="600" fill="#f8fafc">Evaluate</text>
  </g>
  <text x="850" y="228" text-anchor="middle" font-size="10" fill="#64748b">Diagnostics &amp;</text>
  <text x="850" y="241" text-anchor="middle" font-size="10" fill="#64748b">extensions</text>

  <!-- Tool labels -->
  <rect x="232" y="99" width="116" height="18" rx="4" fill="#0f766e" opacity="0.15"/>
  <text x="290" y="112" text-anchor="middle" font-size="9" fill="#0f766e" font-weight="600">SIMULATOR</text>

  <rect x="437" y="180" width="106" height="18" rx="4" fill="#2563eb" opacity="0.15"/>
  <text x="490" y="193" text-anchor="middle" font-size="9" fill="#2563eb" font-weight="600">IMPACT ENGINE</text>

  <rect x="437" y="118" width="106" height="18" rx="4" fill="#dc2626" opacity="0.15"/>
  <text x="490" y="131" text-anchor="middle" font-size="9" fill="#dc2626" font-weight="600">IMPACT ENGINE</text>
</svg>
